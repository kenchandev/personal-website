language: node_js

os:
  - linux
  - osx

node_js:
  - "node"
  - "lts/*"
  - 10

cache: npm

script:
  - npm install
  - npm run format:check
  - npm run lint
  - npm run test

jobs:
  include:
    - stage: prod-build-deploy
      name: "Build Production Site and Deploy to GitHub Pages"
      os: linux
      node_js: "lts/*"
      script: npm run build:prod && echo "Deploying to GitHub Pages..."
      if: branch = master
      deploy:
        provider: pages
        skip-cleanup: true
        local-dir: dist/
        github-token: $GITHUB_API_KEY
        keep-history: true
        repo: kenchandev/kenchandev.github.io
        target-branch: master
        on:
          branch: master
